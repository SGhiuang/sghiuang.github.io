<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>实验四：电表校正</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* 保持原有CSS样式不变 */
        :root { --primary-color: #3498db; --text-color: #2c3e50; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0; padding: 15px; background-color: #f5f7f9; }
        .container { max-width: 800px; margin: 0 auto; position: relative; }
        .home-btn { position: absolute; top: 10px; right: 15px; padding: 10px 20px;
            background-color: var(--primary-color); color: white; border: none;
            border-radius: 8px; font-size: 0.95rem; font-weight: 500; text-decoration: none;
            transition: all 0.3s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); cursor: pointer; }
        .card { background: white; border-radius: 10px; padding: 15px; margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); }
        .input-group { margin: 10px 0; }
        input { box-sizing: border-box; width: calc(100% - 20px); padding: 10px;
            border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; margin: 8px 10px; }
        button { width: 100%; padding: 12px 24px; margin: 20px 0; background-color: var(--primary-color);
            color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: 500;
            transition: all 0.3s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); cursor: pointer; }
        /* 其他样式保持不变... */
    </style>
</head>

<body>
    <div class="container">
        <a href="/" class="home-btn">返回主页</a>
        <h1 style="text-align: center;">箱式电势差计校正电表</h1>

        <!-- 电流表校正 -->
        <div class="card">
            <h2>校正50μA电流表</h2>
            <div class="input-group">
                <input type="number" id="r_current" placeholder="电阻R (Ω)" step="0.1">
            </div>
            <div class="input-group">
                <input type="number" id="ur0" placeholder="0μA 对应Ur (mV)" step="0.01">
                <input type="number" id="ur1" placeholder="10μA 对应Ur (mV)" step="0.01">
                <input type="number" id="ur2" placeholder="20μA 对应Ur (mV)" step="0.01">
                <input type="number" id="ur3" placeholder="30μA 对应Ur (mV)" step="0.01">
                <input type="number" id="ur4" placeholder="40μA 对应Ur (mV)" step="0.01">
                <input type="number" id="ur5" placeholder="50μA 对应Ur (mV)" step="0.01">
            </div>
        </div>

        <!-- 电压表校正 -->
        <div class="card">
            <h2>校正3V电压表</h2>
            <div class="input-group">
                <input type="number" id="r1" placeholder="电阻R1 (Ω)" step="0.1">
                <input type="number" id="r2" placeholder="电阻R2 (Ω)" step="0.1">
            </div>
            <div class="input-group">
                <input type="number" id="urv0" placeholder="0V 对应Ur (mV)" step="0.01">
                <input type="number" id="urv1" placeholder="0.5V 对应Ur (mV)" step="0.01">
                <input type="number" id="urv2" placeholder="1.0V 对应Ur (mV)" step="0.01">
                <input type="number" id="urv3" placeholder="1.5V 对应Ur (mV)" step="0.01">
                <input type="number" id="urv4" placeholder="2.0V 对应Ur (mV)" step="0.01">
                <input type="number" id="urv5" placeholder="2.5V 对应Ur (mV)" step="0.01">
                <input type="number" id="urv6" placeholder="3.0V 对应Ur (mV)" step="0.01">
            </div>
        </div>

        <button onclick="calculate()">开始计算</button>

        <div class="card">
            <h2>计算结果</h2>
            <pre id="results"></pre>
        </div>

        <button onclick="exportReport()" id="exportBtn">导出实验报告</button>
    </div>
    <div class="watermark"></div>

    <script>
        function calculate() {
            // 电流表数据处理
            const r = parseFloat(document.getElementById('r_current').value);
            const urCurrent = [];
            for (let i = 0; i < 6; i++) {
                urCurrent.push(parseFloat(document.getElementById(`ur${i}`).value));
            }

            // 电压表数据处理
            const r1 = parseFloat(document.getElementById('r1').value);
            const r2 = parseFloat(document.getElementById('r2').value);
            const urVoltage = [];
            for (let i = 0; i < 7; i++) {
                urVoltage.push(parseFloat(document.getElementById(`urv${i}`).value));
            }

            // 计算结果
            let output = "====================\n电流表校准结果：\n";
            output += "Ix/μA | Ur/mV | Is/μA | ΔIx/μA\n";
            output += "--------------------------------\n";
            
            [0, 10, 20, 30, 40, 50].forEach((ix, i) => {
                const is = (urCurrent[i]/1000 / r * 1e6).toFixed(2);
                const delta = (ix - is).toFixed(2);
                output += `${ix.toString().padStart(5)} | ${urCurrent[i].toFixed(2).padStart(5)} | ${is.padStart(6)} | ${delta.padStart(6)}\n`;
            });

            output += "\n====================\n电压表校准结果：\n";
            output += "Ux/V  | Ur/mV | Us/V   | ΔUx/V\n";
            output += "--------------------------------\n";
            
            [0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0].forEach((ux, i) => {
                const us = ((r2/r1) * (urVoltage[i]/1000)).toFixed(3);
                const delta = (ux - us).toFixed(3);
                output += `${ux.toFixed(1).padStart(4)} | ${urVoltage[i].toFixed(2).padStart(5)} | ${us.padStart(6)} | ${delta.padStart(6)}\n`;
            });

            document.getElementById('results').innerHTML = output
                .replace(/\n/g, '<br>')
                .replace(/ /g, '&nbsp;');
        }

        // 保持原有的导出功能
        async function exportReport() {
            /* 原有导出代码保持不变 */
        }
    </script>
</body>
</html>